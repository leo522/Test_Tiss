@{
    Layout = "~/Views/Shared/_TissMaster.cshtml";
}
<!DOCTYPE html>
<html>
<head>
    <link href="~/site/css/ViewArticle.css" rel="stylesheet" />
    <link href="~/site/css/MenuLinkStyle.css" rel="stylesheet" />
</head>
<body>
    <div class="container-fluid px-0 mt-header">
        <div class="BasePageLayout">
            <div class="BasePageBanner position-relative">
                <div class="Mask"></div>
                <img class="PageBannerItemBg img-fluid" src="/site/img/about_banner_1.cb027849.jpg" alt="中心介紹封面圖片">
                <div class="container text-center">
                    <div class="Title">
                        <h1 class="BannerTitle" title="About TISS">About TISS</h1>
                        <h2 class="BannerSubTitle">
                            <img class="icon" src="/site/img/title_icon_white.5e98ec4e.svg" alt="中心介紹" title="中心介紹">中心介紹
                        </h2>
                    </div>
                </div>
            </div>
            <section class="row no-gutters">
                <aside class="col-lg-3">
                    <div class="BaseBreadcrumb d-block d-lg-none">
                        <div class="container">
                            <nav aria-label="breadcrumb">
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item">
                                        <a href="/Tiss/Home" title="首頁">首頁</a>
                                    </li>
                                    <li class="breadcrumb-item active" aria-current="page">中心介紹</li>
                                </ol>
                            </nav>
                        </div>
                    </div>
                    <div class="content">
                        <div class="Title" title="中心介紹">中心介紹</div>
                        <ul class="list-group">
                            <li class="list-group-item">
                                <a class="MenuLink" href="/Tiss/Objectives" title="使命、願景">使命、願景</a>
                            </li>
                            <li class="list-group-item">
                                <a class="MenuLink" href="/Tiss/mission" title="中心任務">中心任務</a>
                            </li>
                            <li class="list-group-item">
                                <a class="MenuLink" href="/Tiss/Organization" title="組織概況">組織概況</a>
                            </li>
                            <li class="list-group-item">
                                <a class="MenuLink" href="/Tiss/BOD" title="第1屆 董監事">第1屆 董監事</a>
                            </li>
                            <li class="list-group-item">
                                <a class="MenuLink" href="/Tiss/CEO" title="執行長">執行長</a>
                            </li>
                            <li class="list-group-item">
                                <a class="MenuLink" href="/Tiss/Units" title="單位介紹">單位介紹</a>
                            </li>
                        </ul>
                    </div>
                </aside>
                <main class="col-lg-9 bg-light">
                    <div class="MainContainer">
                        <div class="BaseBreadcrumb d-none d-lg-block">
                            <div class="container">
                                <nav aria-label="breadcrumb">
                                    <ol class="breadcrumb">
                                        <li class="breadcrumb-item">
                                            <a href="/Tiss/Home" title="首頁">首頁</a>
                                        </li>
                                        <li class="breadcrumb-item active" aria-current="page">中心介紹</li>
                                    </ol>
                                </nav>
                            </div>
                        </div>
                    </div>
                    <div class="Objectives">
                        <div class="content">
                            <div class="contentBox">
                                <div class="SubTitle">
                                    <h3 title="使命、願景">使命、願景</h3>
                                    <h4 class="primary" title="Objectives">Objectives</h4>
                                </div>
                                <div>
                                    @{ if (Session["LoggedIn"] != null && (bool)Session["LoggedIn"])
                                        {
                                            <div>
                                                <div class="Intro" id="intro" contenteditable="true" title="推動運動科學研究及應用，提升國際運動競爭力">推動運動科學研究及應用，提升國際運動競爭力</div>
                                                <div class="SubIntro" id="subIntro" contenteditable="true" title="TO PROMOTE OUR RESEARCH ACHIEVEMENTS IN SPORTS SCIENCE AND TO ENHANCE OUR INTERNATIONAL ATHLETIC COMPETITIVENESS">TO PROMOTE OUR RESEARCH ACHIEVEMENTS IN SPORTS SCIENCE AND TO ENHANCE OUR INTERNATIONAL ATHLETIC COMPETITIVENESS</div>
                                            </div>
                                        }
                                        else
                                        {
                                            <div>
                                                <div class="Intro" id="intro" title="推動運動科學研究及應用，提升國際運動競爭力">推動運動科學研究及應用，提升國際運動競爭力</div>
                                                <div class="SubIntro" id="subIntro" title="TO PROMOTE OUR RESEARCH ACHIEVEMENTS IN SPORTS SCIENCE AND TO ENHANCE OUR INTERNATIONAL ATHLETIC COMPETITIVENESS">TO PROMOTE OUR RESEARCH ACHIEVEMENTS IN SPORTS SCIENCE AND TO ENHANCE OUR INTERNATIONAL ATHLETIC COMPETITIVENESS</div>
                                            </div>
                                        }
                                    }
                                </div>
                                <img class="ObjectivesImg img-fluid" id="mainImage" alt="中心使命願景圖片">
                            </div>
                        </div>
                        @{
                            if (Session["LoggedIn"] != null && (bool)Session["LoggedIn"])
                            {
                                <div class="btn-container mt-3">
                                    <input type="file" id="uploadImageInput" class="d-none" accept="image/*">
                                    <button class="btn btn-outline-primary" onclick="changeImg()">新增圖片</button>
                                    <button class="btn btn-outline-success" onclick="saveContent()">儲存</button>
                                </div>
                            }
                        }
                        <div class="Mission">
                            <div class="content">
                                <div class="SubTitle">
                                    <h3 title="中心任務">中心任務</h3>
                                    <h4 class="primary" title="Mission">Mission</h4>
                                </div>
                                <hr>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">
                                        <strong>01</strong> 辦理國家優秀運動選手培訓、參賽所需之運動科學支援服務、健康管理及醫療照護
                                    </li>
                                    <li class="list-group-item">
                                        <strong>02</strong> 辦理國際運動賽事資訊之蒐集、分析及支援
                                    </li>
                                    <li class="list-group-item">
                                        <strong>03</strong> 推動運動科學之研究
                                    </li>
                                    <li class="list-group-item">
                                        <strong>04</strong> 進行運動科技之研發、技術移轉及加值應用，提升產業競爭力
                                    </li>
                                    <li class="list-group-item">
                                        <strong>05</strong> 促進國內外運動科學研究機構之合作交流
                                    </li>
                                    <li class="list-group-item">
                                        <strong>06</strong> 協助規劃及培育運動科學專業人才
                                    </li>
                                    <li class="list-group-item">
                                        <strong>07</strong> 運動科學成果推廣全民運用
                                    </li>
                                    <li class="list-group-item text-center">
                                        <svg class="svg-inline--fa fa-flag" aria-hidden="true" focusable="false" data-prefix="far" data-icon="flag" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                            <path class="" fill="currentColor" d="M48 24C48 10.7 37.3 0 24 0S0 10.7 0 24V64 350.5 400v88c0 13.3 10.7 24 24 24s24-10.7 24-24V388l80.3-20.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L48 52V24zm0 77.5l96.6-24.2c27-6.7 55.5-3.6 80.4 8.8c54.9 27.4 118.7 29.7 175 6.8V334.7l-24.4 9.1c-33.7 12.6-71.2 10.7-103.4-5.4c-48.2-24.1-103.3-30.1-155.6-17.1L48 338.5v-237z">
                                            </path>
                                        </svg>
                                        <div class="MissionItemContent mt-2" title="與TISS一起持續推動臺灣運動科學發展">與TISS一起持續推動臺灣運動科學發展</div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="Organization">
                            <div class="content">
                                <div class="SubTitle">
                                    <h3 title="組織概況">組織概況</h3>
                                    <h4 class="primary" title="Organization Structure">Organization Structure</h4>
                                </div>
                                <div class="row">
                                    <div class="col-sm-6 col-md-4">
                                        <a href="/Tiss/BOD" class="OrganizationItem text-decoration-none">
                                            <div class="ItemTitle" title="董事會">董事會</div>
                                            <div class="ItemSubTitle" title="Board of Directors">Board of Directors</div>
                                        </a>
                                    </div>
                                    <div class="col-sm-6 col-md-4">
                                        <a href="/Tiss/BOD" class="OrganizationItem text-decoration-none">
                                            <div class="ItemTitle" title="董事長">董事長</div>
                                            <div class="ItemSubTitle" title="Chairman">Chairman</div>
                                        </a>
                                    </div>
                                    <div class="col-sm-6 col-md-4">
                                        <a href="/Tiss/CEO" class="OrganizationItem text-decoration-none">
                                            <div class="ItemTitle" title="執行長">執行長</div>
                                            <div class="ItemSubTitle" title="CEO">CEO</div>
                                        </a>
                                    </div>
                                    <div class="col-sm-6 col-md-4">
                                        <div class="OrganizationItem">
                                            <div class="ItemTitle" title="副執行長">副執行長</div>
                                            <div class="ItemSubTitle" title="Associate CEO">Associate CEO</div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6 col-md-4">
                                        <div class="OrganizationItem">
                                            <div class="ItemTitle" title="主任秘書">主任秘書</div>
                                            <div class="ItemSubTitle" title="Chief Secretary">Chief Secretary</div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6 col-md-4">
                                        <div class="OrganizationItem">
                                            <div class="ItemTitle" title="運動科學研究處">運動科學研究處</div>
                                            <div class="ItemSubTitle" title="Department of Sport Science Research">Department of Sport Science Research</div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6 col-md-4">
                                        <div class="OrganizationItem">
                                            <div class="ItemTitle" title="運動科技與資訊開發處">運動科技與資訊開發處</div>
                                            <div class="ItemSubTitle" title="Department of Sport Technology and Information">Department of Sport Technology and Information</div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6 col-md-4">
                                        <div class="OrganizationItem">
                                            <div class="ItemTitle" title="運動醫學研究處">運動醫學研究處</div>
                                            <div class="ItemSubTitle" title="Department of Sport Medicine Research">Department of Sport Medicine Research</div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6 col-md-4">
                                        <div class="OrganizationItem">
                                            <div class="ItemTitle" title="行政管理處">行政管理處</div>
                                            <div class="ItemSubTitle" title="Department of Administration">Department of Administration</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </section>
        </div>
    </div>


    <script>
    $(document).ready(function () {
        var isLoggedIn = '@Session["LoggedIn"]' == 'True';

        if (isLoggedIn) {
            $('#logoutBtn').show(); // 顯示登出按鈕
        } else {
            $('#loginBtn').show(); // 顯示登入按鈕
        }

        loadContent(); // 加載已儲存的內容

        // navbar 導航列
        var currentUrl = window.location.pathname;
        var menuLinks = document.querySelectorAll('.MenuLink');

        menuLinks.forEach(function (link) {
            if (link.getAttribute('href') === currentUrl) {
                link.classList.add('active');
            }
        });

        // 增加圖片功能
        document.getElementById('uploadImageInput').addEventListener('change', function () {
            var file = this.files[0];
            if (file) {
                var reader = new FileReader();
                reader.onload = function (event) {
                    document.getElementById('mainImage').src = event.target.result;
                };
                reader.readAsDataURL(file);
            }
        });
    });

    // 載入已儲存的內容
    function loadContent() {
        $.ajax({
            url: 'organizationGetContent',
            method: 'GET',
            success: function (response) {
                if (response.success) {
                    document.getElementById('intro').innerText = response.textContent;
                    document.getElementById('mainImage').src = response.imagePath;
                } else {
                    console.error('載入失敗: ' + response.error);
                }
            },
            error: function (err) {
                console.error('載入失敗', err);
            }
        });
    }

    // 圖片及文字存檔功能
    function saveContent() {
        var textContent = document.getElementById('intro').innerHTML;
        var imageSrc = document.getElementById('mainImage').src;

        $.ajax({
            url: 'organizationSaveContent',
            method: 'POST',
            data: {
                TextContent: textContent,
                ImageSrc: imageSrc
            },
            success: function (response) {
                if (response.success) {
                    document.getElementById('mainImage').src = response.imagePath;
                    alert('內容已儲存');
                } else {
                    alert('儲存失敗: ' + response.error);
                }
            },
            error: function (err) {
                console.error('儲存失敗', err);
            }
        });
    }

    // 切換下拉菜單
    function toggleDropdown(dropdownId) {
        var dropdownToggle = document.getElementById(dropdownId);
        var dropdownMenu = dropdownToggle.nextElementSibling;

        if (dropdownMenu.classList.contains('show')) {
            dropdownMenu.classList.remove('show');
        } else {
            dropdownMenu.classList.add('show');
        }
    }
    </script>

</body>
</html>